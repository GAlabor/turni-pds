<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover">

  <!-- PWA / status bar iOS -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="mobile-web-app-capable" content="yes">

  <!-- Barra indirizzi / status bar colore (dove supportato) -->
  <meta name="theme-color" content="#e7ecff" media="(prefers-color-scheme: light)">
  <meta name="theme-color" content="#020617" media="(prefers-color-scheme: dark)">

  <link rel="manifest" href="manifest.webmanifest">
  <link rel="icon" href="favicon.ico">
  <title>Turni PDS</title>

  <!-- CSS -->
  <link rel="stylesheet" href="css/base.css">
  <link rel="stylesheet" href="css/calendar.css">
  <link rel="stylesheet" href="css/settings.css">
  <link rel="stylesheet" href="css/turni.css">
  <link rel="stylesheet" href="css/components.css">
  <link rel="stylesheet" href="css/tabbar.css">
</head>

<body>

  <!-- ICONA STATO / SALVATAGGIO -->
  <div id="statusIcon" class="app-status status-idle">
    <div id="icoStatus"></div>
  </div>

  <main class="app-shell">
    <!-- VISTA CALENDARIO -->
    <section class="view view-calendar is-active" data-view="calendar">
      <header class="app-header">
        <h1 class="app-title">Turni</h1>
      </header>

      <!-- Selettore mese -->
      <section class="monthbar">
        <button class="nav-btn prev" type="button" aria-label="Mese precedente">
          <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M14 6 L8 12 L14 18" />
          </svg>
        </button>
        <div class="month-label"></div>
        <button class="nav-btn next" type="button" aria-label="Mese successivo">
          <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M10 6 L16 12 L10 18" />
          </svg>
        </button>
      </section>

      <!-- Contenitore calendario -->
      <div class="calendar-wrapper">
        <div class="calendar-container mode-days" id="calendarContainer">
          <div class="dow-row">
            <div class="dow">Lun</div>
            <div class="dow">Mar</div>
            <div class="dow">Mer</div>
            <div class="dow">Gio</div>
            <div class="dow">Ven</div>
            <div class="dow">Sab</div>
            <div class="dow">Dom</div>
          </div>

          <!-- Griglia giorni -->
          <div class="calendar-grid" id="calendar-grid">
            <!-- Il JS inserirà le celle giorno -->
          </div>

          <!-- Griglia mesi -->
          <div class="month-grid" id="month-grid">
            <!-- Mesi inseriti via JS -->
          </div>

          <!-- Griglia anni -->
          <div class="year-grid" id="year-grid">
            <!-- Anni inseriti via JS -->
          </div>
        </div>
      </div>
    </section>

    <!-- VISTA INSERIMENTI / PAGAMENTI -->
    <section class="view view-inspag" data-view="inspag">
      <header class="app-header">
        <h1 class="app-title">Inserimenti e Pagamenti</h1>
      </header>

      <div class="settings-container">
        <p class="settings-hint">
          Qui in futuro vedrai inserimenti, pagamenti e riepiloghi dedicati.
        </p>
      </div>
    </section>

    <!-- VISTA RIEPILOGO -->
    <section class="view view-riepilogo" data-view="riepilogo">
      <header class="app-header">
        <h1 class="app-title">Riepilogo</h1>
      </header>

      <div class="settings-container">
        <p class="settings-hint">
          In questa sezione potrai vedere i riepiloghi per mese o anno.
        </p>
      </div>
    </section>

    <!-- VISTA IMPOSTAZIONI -->
    <section class="view view-settings" data-view="settings">
      <header class="app-header">
        <!-- Freccia BACK principale, visibile solo dentro i pannelli -->
        <button
          class="settings-back"
          type="button"
          data-settings-back-main
          aria-label="Torna alle impostazioni"
          hidden>
          <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M14 6 L8 12 L14 18" />
          </svg>
        </button>

        <!-- Titolo principale dinamico -->
        <h1 class="app-title" id="settingsTitle">Impostazioni</h1>
      </header>

      <div class="settings-container">
        <!-- Schermata principale impostazioni -->
        <div class="settings-main is-active">

          <!-- CONTENITORE 1 -->
          <div class="settings-group-card">
            <!-- Turni -->
            <button class="settings-row" type="button" data-settings-page="turni">
              <div class="settings-row-left">
                <span class="settings-row-label">Turni</span>
              </div>
              <div class="settings-row-right">
                <span class="settings-row-chevron" aria-hidden="true">
                  <svg viewBox="0 0 24 24" fill="none">
                    <path d="M10 6 L16 12 L10 18" />
                  </svg>
                </span>
              </div>
            </button>
            <hr class="settings-separator">

            <!-- Indennità -->
            <button class="settings-row" type="button" data-settings-page="indennita">
              <div class="settings-row-left">
                <span class="settings-row-label">Indennità</span>
              </div>
              <div class="settings-row-right">
                <span class="settings-row-chevron" aria-hidden="true">
                  <svg viewBox="0 0 24 24" fill="none">
                    <path d="M10 6 L16 12 L10 18" />
                  </svg>
                </span>
              </div>
            </button>
            <hr class="settings-separator">

            <!-- Festività -->
            <button class="settings-row" type="button" data-settings-page="festivita">
              <div class="settings-row-left">
                <span class="settings-row-label">Festività</span>
              </div>
              <div class="settings-row-right">
                <span class="settings-row-chevron" aria-hidden="true">
                  <svg viewBox="0 0 24 24" fill="none">
                    <path d="M10 6 L16 12 L10 18" />
                  </svg>
                </span>
              </div>
            </button>
          </div>

          <!-- CONTENITORE 2 -->
          <div class="settings-group-card">
            <!-- Tema -->
            <button class="settings-row" type="button" data-settings-page="theme">
              <div class="settings-row-left">
                <span class="settings-row-label">Tema</span>
              </div>
              <div class="settings-row-right">
                <span class="settings-row-summary" id="themeSummary"></span>
                <span class="settings-row-chevron" aria-hidden="true">
                  <svg viewBox="0 0 24 24" fill="none">
                    <path d="M10 6 L16 12 L10 18" />
                  </svg>
                </span>
              </div>
            </button>
            <hr class="settings-separator">

            <!-- Versione -->
            <button class="settings-row" type="button" data-settings-page="updates">
              <div class="settings-row-left">
                <span class="settings-row-label">Versione</span>
              </div>
              <div class="settings-row-right">
                <span class="settings-row-chevron" aria-hidden="true">
                  <svg viewBox="0 0 24 24" fill="none">
                    <path d="M10 6 L16 12 L10 18" />
                  </svg>
                </span>
              </div>
            </button>
            <hr class="settings-separator">

            <!-- Info -->
            <button class="settings-row" type="button" data-settings-page="info">
              <div class="settings-row-left">
                <span class="settings-row-label">Info</span>
              </div>
              <div class="settings-row-right">
                <span class="settings-row-chevron" aria-hidden="true">
                  <svg viewBox="0 0 24 24" fill="none">
                    <path d="M10 6 L16 12 L10 18" />
                  </svg>
                </span>
              </div>
            </button>
          </div>

        </div>

        <!-- PANNELLO TEMA -->
        <div class="settings-panel settings-theme" data-settings-id="theme">
          <div class="settings-group">
            <p class="settings-hint">
              Scegli come visualizzare Turni PDS.
            </p>
          </div>

          <button class="settings-choice" data-theme="system">
            <span class="settings-choice-label" data-theme-label="system"></span>
          </button>

          <button class="settings-choice" data-theme="light">
            <span class="settings-choice-label" data-theme-label="light"></span>
          </button>

          <button class="settings-choice" data-theme="dark">
            <span class="settings-choice-label" data-theme-label="dark"></span>
          </button>
        </div>

        <!-- PANNELLO TURNI (lista + pulsanti) -->
        <div class="settings-panel settings-turni" data-settings-id="turni">
          <div class="turni-card">
            <div class="turni-card-header">
              <h2 class="turni-panel-title">Turni</h2>

              <div class="turni-card-actions">
                <button class="pill-btn" type="button" data-turni-edit disabled>
                  Modifica
                </button>
                <button class="icon-circle-btn" type="button" data-turni-add aria-label="Aggiungi turno">
                  <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
                    <path d="M12 5 L12 19" />
                    <path d="M5 12 L19 12" />
                  </svg>
                </button>
                <button
                  class="turni-toggle-btn"
                  type="button"
                  data-turni-toggle
                  aria-label="Mostra o nascondi i turni"
                  aria-expanded="true">
                  <!-- arrow-up.svg inline -->
                  <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
                    <path d="M6 14 L12 8 L18 14" />
                  </svg>
                </button>
              </div>
            </div>

            <!-- Lista turni salvati -->
            <div class="turni-list" data-turni-list></div>

            <!-- Hint quando non ci sono turni -->
            <p class="turni-empty-hint" data-turni-empty-hint>
              Nessun turno salvato. Tocca + per aggiungerne uno.
            </p>
          </div>
        </div>

        <!-- PANNELLO AGGIUNGI TURNO -->
        <div
          class="settings-panel settings-turni-add"
          data-settings-id="turni-add"
          data-settings-title="Aggiungi turno">

          <!-- Toolbar Salva + messaggio errore -->
          <div class="turni-add-toolbar">
            <button class="pill-btn turni-save-btn" type="button" data-turni-save>
              Salva
            </button>
            <p class="turni-error" data-turni-error hidden>
              Compila tutti i campi
            </p>
          </div>

          <!-- Form Aggiungi turno (righe-card) -->
          <div class="turni-form" data-turni-add-form>
            <!-- Turno -->
            <div class="turni-field-row">
              <label class="turni-label" for="addTurnoNome">Turno</label>
              <div class="turni-field-control">
                <input
                  class="turni-input"
                  id="addTurnoNome"
                  type="text"
                  maxlength="15"
                  autocomplete="off">
              </div>
            </div>

            <!-- Sigla + colore + anteprima [M] -->
            <div class="turni-field-row">
              <label class="turni-label" for="addTurnoSigla">Sigla</label>

              <div class="turni-field-control turni-field-control-sigla">
                <input
                  class="turni-input"
                  id="addTurnoSigla"
                  type="text"
                  maxlength="4"
                  autocomplete="off">

                <!-- Il pallino DIVENTA un label collegato all'input colore -->
                <label
                  class="turni-color-dot"
                  for="addTurnoColore"
                  data-turni-color-trigger
                  aria-label="Scegli colore sigla">
                  <span class="turni-color-preview" data-turni-color-preview></span>
                </label>

                <div class="turni-sigla-preview-pill" aria-hidden="true">
                  <span class="turni-sigla-preview-text" data-turni-sigla-preview></span>
                </div>

                <input
                  class="turni-color-input"
                  id="addTurnoColore"
                  type="color"
                  value="#0a84ff"
                  data-turni-color>
              </div>
            </div>

            <!-- Ora inizio -->
            <div class="turni-field-row">
              <label class="turni-label" for="addTurnoOraInizio">Ora inizio</label>
              <div class="turni-field-control">
                <input
                  class="turni-input"
                  id="addTurnoOraInizio"
                  type="time"
                  inputmode="numeric"
                  data-time-fix-24>
              </div>
            </div>

            <!-- Ora fine -->
            <div class="turni-field-row">
              <label class="turni-label" for="addTurnoOraFine">Ora fine</label>
              <div class="turni-field-control">
                <input
                  class="turni-input"
                  id="addTurnoOraFine"
                  type="time"
                  inputmode="numeric"
                  data-time-fix-24>
              </div>
            </div>
          </div>
        </div>

        <!-- PANNELLO INDENNITÀ -->
        <div class="settings-panel settings-indennita" data-settings-id="indennita">
          <!-- volutamente vuoto per ora -->
        </div>

        <!-- PANNELLO FESTIVITÀ -->
        <div class="settings-panel settings-festivita" data-settings-id="festivita">
          <!-- volutamente vuoto per ora -->
        </div>

        <!-- PANNELLO INFO -->
        <div class="settings-panel settings-info" data-settings-id="info">
          <!-- volutamente vuoto per ora -->
        </div>

        <!-- PANNELLO VERSIONE -->
        <div class="settings-panel settings-updates" data-settings-id="updates">
          <!-- volutamente vuoto per ora -->
        </div>
      </div>
    </section>
  </main>

  <!-- TABBAR IN BASSO -->
  <nav class="tabbar" aria-label="Barra schede">
    <button class="tab active" data-tab="calendar" aria-label="Calendario">
      <svg id="icoCalendar" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
           fill="none" stroke="currentColor"
           stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"></svg>
      <span class="tab-label">Calendario</span>
    </button>

    <button class="tab" data-tab="riepilogo" aria-label="Riepilogo">
      <svg id="icoRiepilogo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
           fill="none" stroke="currentColor"
           stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"></svg>
      <span class="tab-label">Riepilogo</span>
    </button>

    <button class="tab" data-tab="inspag" aria-label="Inserimenti e pagamenti">
      <svg id="icoInspag" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
           fill="none" stroke="currentColor"
           stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"></svg>
      <span class="tab-label">Ins/Pag</span>
    </button>

    <button class="tab" data-tab="settings" aria-label="Impostazioni">
      <svg id="icoSettings" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
           fill="none" stroke="currentColor"
           stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"></svg>
      <span class="tab-label">Impostazioni</span>
    </button>
  </nav>

  <!-- Etichetta versione -->
  <div id="versionLabel" class="version-label"></div>

  <!-- JS -->
  <script src="js/config.js" defer></script>
  <script src="js/calendar.js" defer></script>
  <script src="js/theme.js" defer></script>
  <script src="js/status.js" defer></script>
  <script src="js/icons.js" defer></script>
  <script src="js/settings.js" defer></script>
  <script src="js/turni.js" defer></script>
  <script src="js/app.js" defer></script>
  <script src="js/sw-register.js" defer></script>

</body>
</html>
