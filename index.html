<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover">

  <!-- PWA / status bar iOS -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="mobile-web-app-capable" content="yes">

  <!-- Barra indirizzi / status bar colore (dove supportato) -->
  <meta name="theme-color" content="#e7ecff" media="(prefers-color-scheme: light)">
  <meta name="theme-color" content="#020617" media="(prefers-color-scheme: dark)">

  <link rel="manifest" href="manifest.webmanifest">
  <link rel="icon" href="favicon.ico">
  <title>Turni PDS</title>

  <!-- CSS -->
  <link rel="stylesheet" href="css/base.css">
  <link rel="stylesheet" href="css/calendar.css">
  <link rel="stylesheet" href="css/settings.css">
  <link rel="stylesheet" href="css/turni.css">
  <link rel="stylesheet" href="css/components.css">
  <link rel="stylesheet" href="css/tabbar.css">
</head>

<body>

  <!-- ICONA STATO / SALVATAGGIO -->
  <div id="statusIcon" class="app-status status-idle">
    <div id="icoStatus"></div>
  </div>

  <main class="app-shell">
    <!-- VISTA CALENDARIO -->
    <section class="view view-calendar is-active" data-view="calendar">
      <header class="app-header">
        <h1 class="app-title">Turni</h1>
        <p class="app-subtitle">Calendario personale</p>
      </header>

      <!-- Selettore mese -->
      <section class="monthbar">
        <button class="nav-btn prev" type="button" aria-label="Mese precedente">
          <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M14 6 L8 12 L14 18" />
          </svg>
        </button>
        <div class="month-label"></div>
        <button class="nav-btn next" type="button" aria-label="Mese successivo">
          <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M10 6 L16 12 L10 18" />
          </svg>
        </button>
      </section>

      <!-- Contenitore calendario -->
      <div class="calendar-wrapper">
        <div class="calendar-container mode-days" id="calendarContainer">
          <div class="dow-row" id="dowRow">
            <div class="dow">Lun</div>
            <div class="dow">Mar</div>
            <div class="dow">Mer</div>
            <div class="dow">Gio</div>
            <div class="dow">Ven</div>
            <div class="dow">Sab</div>
            <div class="dow">Dom</div>
          </div>

          <!-- Griglia giorni -->
          <div class="calendar-grid" id="calendar-grid">
            <!-- Il JS inserirà le celle giorno -->
          </div>

          <!-- Griglia mesi -->
          <div class="month-grid" id="month-grid">
            <!-- Mesi inseriti via JS -->
          </div>

          <!-- Griglia anni -->
          <div class="year-grid" id="year-grid">
            <!-- Anni inseriti via JS -->
          </div>
        </div>
      </div>
    </section>

    <!-- VISTA INSERIMENTI / PAGAMENTI -->
    <section class="view view-inspag" data-view="inspag">
      <header class="app-header">
        <h1 class="app-title">Inserimenti e Pagamenti</h1>
        <p class="app-subtitle">Schermata in lavorazione</p>
      </header>

      <div class="settings-container">
        <p class="settings-hint">
          Qui in futuro vedrai inserimenti, pagamenti e riepiloghi dedicati.
        </p>
      </div>
    </section>

    <!-- VISTA RIEPILOGO -->
    <section class="view view-riepilogo" data-view="riepilogo">
      <header class="app-header">
        <h1 class="app-title">Riepilogo</h1>
        <p class="app-subtitle">Ricerca e riepilogo mensile</p>
      </header>

      <div class="settings-container">
        <p class="settings-hint">
          In questa sezione potrai vedere i riepiloghi per mese o anno.
        </p>
      </div>
    </section>

    <!-- VISTA IMPOSTAZIONI -->
    <section class="view view-settings" data-view="settings">
      <header class="app-header">
        <h1 class="app-title">Impostazioni</h1>
        <p class="app-subtitle">Aspetto e preferenze</p>
      </header>

      <div class="settings-container">
        <!-- Schermata principale impostazioni -->
        <div class="settings-main is-active">
          <!-- Tema -->
          <button class="settings-row" type="button" data-settings-page="theme">
            <div class="settings-row-left">
              <span class="settings-row-label">Tema</span>
            </div>
            <div class="settings-row-right">
              <span class="settings-row-summary" id="themeSummary"></span>
              <span class="settings-row-chevron" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none">
                  <path d="M10 6 L16 12 L10 18" />
                </svg>
              </span>
            </div>
          </button>
          <hr class="settings-separator">

          <!-- Turni -->
          <button class="settings-row" type="button" data-settings-page="turni">
            <div class="settings-row-left">
              <span class="settings-row-label">Turni</span>
            </div>
            <div class="settings-row-right">
              <span class="settings-row-chevron" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none">
                  <path d="M10 6 L16 12 L10 18" />
                </svg>
              </span>
            </div>
          </button>
          <hr class="settings-separator">

          <!-- Indennità -->
          <button class="settings-row" type="button" data-settings-page="indennita">
            <div class="settings-row-left">
              <span class="settings-row-label">Indennità</span>
            </div>
            <div class="settings-row-right">
              <span class="settings-row-chevron" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none">
                  <path d="M10 6 L16 12 L10 18" />
                </svg>
              </span>
            </div>
          </button>
          <hr class="settings-separator">

          <!-- Festività -->
          <button class="settings-row" type="button" data-settings-page="festivita">
            <div class="settings-row-left">
              <span class="settings-row-label">Festività</span>
            </div>
            <div class="settings-row-right">
              <span class="settings-row-chevron" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none">
                  <path d="M10 6 L16 12 L10 18" />
                </svg>
              </span>
            </div>
          </button>
          <hr class="settings-separator">

          <!-- Informazioni -->
          <button class="settings-row" type="button" data-settings-page="info">
            <div class="settings-row-left">
              <span class="settings-row-label">Informazioni</span>
            </div>
            <div class="settings-row-right">
              <span class="settings-row-chevron" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none">
                  <path d="M10 6 L16 12 L10 18" />
                </svg>
              </span>
            </div>
          </button>
          <hr class="settings-separator">

          <!-- Aggiornamenti -->
          <button class="settings-row" type="button" data-settings-page="updates">
            <div class="settings-row-left">
              <span class="settings-row-label">Aggiornamenti</span>
            </div>
            <div class="settings-row-right">
              <span class="settings-row-chevron" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none">
                  <path d="M10 6 L16 12 L10 18" />
                </svg>
              </span>
            </div>
          </button>
        </div>

        <!-- Schermata scelta tema -->
        <div class="settings-panel settings-theme" data-settings-id="theme">
          <div class="settings-panel-header">
            <button class="settings-back" type="button" data-settings-back aria-label="Torna alle impostazioni">
              <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <path d="M14 6 L8 12 L14 18" />
              </svg>
            </button>
            <span class="settings-panel-title">Tema</span>
          </div>

          <div class="settings-group">
            <button class="settings-choice" type="button" data-theme="system">
              <span class="settings-choice-label">Tema corrente</span>
            </button>
            <button class="settings-choice" type="button" data-theme="dark">
              <span class="settings-choice-label">Tema scuro</span>
            </button>
            <button class="settings-choice" type="button" data-theme="light">
              <span class="settings-choice-label">Tema chiaro</span>
            </button>
          </div>
        </div>

        <!-- Pannello Turni -->
        <div class="settings-panel settings-turni" data-settings-id="turni">
          <div class="settings-panel-header">
            <button class="settings-back" type="button" data-settings-back aria-label="Torna alle impostazioni">
              <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <path d="M14 6 L8 12 L14 18" />
              </svg>
            </button>
            <span class="settings-panel-title">Turni</span>
          </div>

          <!-- Toggle visualizzazione turnazione su calendario -->
          <div class="settings-group">
            <div class="settings-row settings-row-toggle">
              <div class="settings-row-left settings-row-left-column">
                <span class="settings-row-label">Visualizza turnazione su calendario</span>
                <p class="settings-row-subhint">
                  Mostra le lettere della turnazione sul calendario.
                </p>
              </div>
              <div class="settings-row-right">
                <button
                  class="toggle-switch"
                  type="button"
                  data-turni-visual-toggle
                  aria-pressed="false"
                  aria-label="Attiva o disattiva la visualizzazione turni su calendario">
                  <span class="toggle-knob" aria-hidden="true"></span>
                </button>
              </div>
            </div>
            <hr class="settings-separator">
          </div>

          <!-- Sezione turni personalizzati -->
          <div class="turni-section">
            <!-- Riga cliccabile: Aggiungi turno + cerchietto con freccia -->
            <button class="turni-row" type="button" data-turni-open aria-expanded="false">
              <span class="turni-row-label">Aggiungi turno</span>
              <span class="turni-add-btn" aria-hidden="true">
                <svg viewBox="0 0 24 24" fill="none">
                  <path d="M6 10 L12 16 L18 10" />
                </svg>
              </span>
            </button>

            <!-- Form inserimento turno (inizialmente nascosto) -->
            <div class="turni-form" data-turni-form hidden>
              <!-- Rigo 1: Turno + Sigla -->
              <div class="turni-field-row">
                <div class="turni-field">
                  <label class="turni-label" for="turnoNome">Turno</label>
                  <input class="turni-input" id="turnoNome" type="text" maxlength="15" autocomplete="off">
                </div>
                <div class="turni-field">
                  <label class="turni-label" for="turnoSigla">Sigla</label>
                  <input class="turni-input" id="turnoSigla" type="text" maxlength="4" autocomplete="off">
                </div>
              </div>

              <!-- Rigo 2: Inizio / Fine / Colore -->
              <div class="turni-field-row turni-row-time-color">
                <div class="turni-field">
                  <label class="turni-label" for="turnoOraInizio">Inizio</label>
                  <input class="turni-input" id="turnoOraInizio" type="time" inputmode="numeric">
                </div>

                <div class="turni-field">
                  <label class="turni-label" for="turnoOraFine">Fine</label>
                  <input class="turni-input" id="turnoOraFine" type="time" inputmode="numeric">
                </div>

                <div class="turni-field turni-field-color">
                  <label class="turni-label" for="turnoColore">Colore</label>
                  <button class="turni-color-dot" type="button" data-turni-color-trigger aria-label="Scegli colore turno">
                    <span class="turni-color-preview" data-turni-color-preview></span>
                  </button>
                  <input
                    class="turni-color-input"
                    id="turnoColore"
                    type="color"
                    value="#0a84ff"
                    data-turni-color>
                </div>
              </div>

              <!-- Pulsante Aggiungi -->
              <div class="turni-actions">
                <button class="turni-submit-btn" type="button" data-turni-submit>
                  Aggiungi
                </button>
              </div>
            </div>

            <!-- Lista turni salvati -->
            <div class="turni-list" data-turni-list></div>
          </div>

        </div>

        <!-- Pannello Indennità -->
        <div class="settings-panel settings-indennita" data-settings-id="indennita">
          <div class="settings-panel-header">
            <button class="settings-back" type="button" data-settings-back aria-label="Torna alle impostazioni">
              <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <path d="M14 6 L8 12 L14 18" />
              </svg>
            </button>
            <span class="settings-panel-title">Indennità</span>
          </div>
          <p class="settings-hint">
            Sezione indennità in lavorazione.
          </p>
        </div>

        <!-- Pannello Festività -->
        <div class="settings-panel settings-festivita" data-settings-id="festivita">
          <div class="settings-panel-header">
            <button class="settings-back" type="button" data-settings-back aria-label="Torna alle impostazioni">
              <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <path d="M14 6 L8 12 L14 18" />
              </svg>
            </button>
            <span class="settings-panel-title">Festività</span>
          </div>
          <p class="settings-hint">
            Sezione festività in lavorazione.
          </p>
        </div>

        <!-- Pannello Informazioni -->
        <div class="settings-panel settings-info" data-settings-id="info">
          <div class="settings-panel-header">
            <button class="settings-back" type="button" data-settings-back aria-label="Torna alle impostazioni">
              <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <path d="M14 6 L8 12 L14 18" />
              </svg>
            </button>
            <span class="settings-panel-title">Informazioni</span>
          </div>
          <p class="settings-hint">
            Sezione informazioni in lavorazione.
          </p>
        </div>

        <!-- Pannello Aggiornamenti -->
        <div class="settings-panel settings-updates" data-settings-id="updates">
          <div class="settings-panel-header">
            <button class="settings-back" type="button" data-settings-back aria-label="Torna alle impostazioni">
              <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
                <path d="M14 6 L8 12 L14 18" />
              </svg>
            </button>
            <span class="settings-panel-title">Aggiornamenti</span>
          </div>
          <p class="settings-hint">
            Sezione aggiornamenti in lavorazione.
          </p>
        </div>
      </div>
    </section>
  </main>

  <!-- TABBAR IN BASSO -->
  <nav class="tabbar" aria-label="Barra schede">
    <button class="tab active" data-tab="calendar" aria-label="Calendario">
      <svg id="icoCalendar" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
           fill="none" stroke="currentColor"
           stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"></svg>
      <span class="tab-label">Calendario</span>
    </button>

    <button class="tab" data-tab="inspag" aria-label="Inserimenti e pagamenti">
      <svg id="icoInspag" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
           fill="none" stroke="currentColor"
           stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"></svg>
      <span class="tab-label">Ins/Pag</span>
    </button>

    <button class="tab" data-tab="riepilogo" aria-label="Riepilogo">
      <svg id="icoRiepilogo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
           fill="none" stroke="currentColor"
           stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"></svg>
      <span class="tab-label">Riepilogo</span>
    </button>

    <button class="tab" data-tab="settings" aria-label="Impostazioni">
      <svg id="icoSettings" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
           fill="none" stroke="currentColor"
           stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"></svg>
      <span class="tab-label">Impostazioni</span>
    </button>
  </nav>


  <!-- Etichetta versione -->
  <div id="versionLabel" class="version-label"></div>

  <!-- JS -->
  <script src="js/calendar.js" defer></script>
  <script src="js/theme.js" defer></script>
  <script src="js/status.js" defer></script>
  <script src="js/icons.js" defer></script>
  <script src="js/settings.js" defer></script>
  <script src="js/turni.js" defer></script>
  <script src="js/app.js" defer></script>
  <script src="js/sw-register.js" defer></script>

</body>
</html>
