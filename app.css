/* === TYPE === */
@import url('https://fonts.googleapis.com/css2?family=Manrope:wght@500;600;700&family=Rajdhani:wght@500;600&display=swap');

/* === ROOT VARS (base) === */
:root{
  --iosBlue:#1976d2; --iosBlue-600:#1565c0;

  /* Palette celeste/istituzionale coerente con l’icona */
  --bg:
    radial-gradient(1400px 900px at 80% -10%, rgba(118,179,255,.35) 0%, rgba(255,255,255,0) 60%),
    linear-gradient(180deg, #1b56c9 0%, #1a5fd9 38%, #1450bd 68%, #0f3e95 100%);

  --card:#ffffff;             /* usato come base per fallback chiari */
  --gridBorder:#d9dee6;       /* sovrascritto nel tema vetro */
  --text:#0b1320; --muted:#7a8595;

  /* Stati calendario */
  --sunday:#e04d4d;           /* rosso vivo solo per numero domenica */
  --today: rgba(255,255,255,.20);

  /* Turni default */
  --T-GL:#c68bcf; --T-AP:#a47ac9;

  /* dimensioni comuni */
  --fieldH:44px;

  /* Topbar glow params */
  --bar-h: 60px; --seam: 20px; --blue-rgb: 74,158,255;
  --cx: 50%; --cy: 50%; --glow-x: 50%;
  --core-a1: 0.94; --core-a2: 0.82; --core-a3: 0.66; --core-a4: 0.48; --core-a5: 0.34;
  --mid-a1: 0.18; --mid-a2: 0.12; --mid-a3: 0.08;
  --far-a1: 0.08; --far-a2: 0.05; --far-a3: 0.024;
  --tail: color-mix(in oklch, rgb(var(--blue-rgb)) 0%, var(--bg) 100%);

  /* Tabbar + icons */
  --tabW: 56px; --tabH: 46px; --tabIcon: 22px;
  --tabColor:#eef4ff; --tabColorActive:#ffffff;
  --tabHoverBg:rgba(255,255,255,.12); --tabActiveBg:rgba(255,255,255,.18);

  /* Action icons */
  --actBtn:44px; --actIcon:24px; --actStroke:2.25px;
  --actColor:#cbd4e6; --actColorHi:#ffffff;

  /* interazioni */
  --actHover:rgba(255,255,255,.08);
  --actActive:rgba(255,255,255,.16);

  /* superfici vetro */
  --surface-glass: rgba(12,24,48,.28);
  --surface-opaque:#163a7a;
  --cell-bg:#15428e;

  /* focus ring */
  --focus-ring: 0 0 0 2px rgba(var(--blue-rgb), .45);
}

/* === BASE === */
*{box-sizing:border-box}
html, body { height: 100%; }
body{
  margin:0;
  background: var(--bg) fixed !important;
  color:#ffffff;
  font-family:'Manrope', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, system-ui, 'Helvetica Neue', Arial;
  -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
}
body.no-scroll { overflow: hidden; }
main{ max-width:760px; margin:8px auto calc(90px + env(safe-area-inset-bottom)); padding:0 10px; }

svg, .brandmark svg path, .no-text-shadow{ text-shadow:none; }
.glow-text { text-shadow: 0 1px 1px rgba(0,0,0,.25); }

/* === TOPBAR (glow sobrio) === */
.topbar{
  position: sticky; top: 0; z-index: 20;
  display: flex; align-items: center; gap: 10px; justify-content: center;
  padding: 10px 12px; color: #fff; background: transparent;
  backdrop-filter: blur(12px) saturate(140%);
  -webkit-backdrop-filter: blur(12px) saturate(140%);
  border: 1px solid rgba(255,255,255,.22);
  box-shadow: inset 0 -1px 0 rgba(255,255,255,.26), 0 5px 18px rgba(0,0,0,.24);
}
.topbar::before{
  content: ""; position: absolute; left:0; right:0; top:0;
  height: calc(var(--bar-h) + var(--seam) + 2px); pointer-events:none;
  background:
    linear-gradient(to right,
      transparent 0%,
      color-mix(in oklch, rgba(255,255,255,.3) 25%, transparent) 8%,
      transparent 18%, transparent 82%,
      color-mix(in oklch, rgba(255,255,255,.3) 25%, transparent) 92%, transparent 100%),
    radial-gradient(ellipse 85% 160% at var(--cx) var(--cy),
      rgba(var(--blue-rgb), var(--far-a1)) 0%,
      rgba(var(--blue-rgb), var(--far-a2)) 32%,
      rgba(var(--blue-rgb), var(--far-a3)) 62%,
      var(--tail) 100%),
    radial-gradient(ellipse 60% 130% at var(--cx) var(--cy),
      rgba(var(--blue-rgb), var(--mid-a1)) 0%,
      rgba(var(--blue-rgb), var(--mid-a2)) 26%,
      rgba(var(--blue-rgb), var(--mid-a3)) 56%,
      var(--tail) 100%),
    radial-gradient(ellipse var(--glow-x) 120% at var(--cx) var(--cy),
      rgba(var(--blue-rgb), 1) 0%,
      rgba(var(--blue-rgb), var(--core-a1)) 8%,
      rgba(var(--blue-rgb), var(--core-a2)) 14%,
      rgba(var(--blue-rgb), var(--core-a3)) 22%,
      rgba(var(--blue-rgb), var(--core-a4)) 32%,
      rgba(var(--blue-rgb), var(--core-a5)) 44%,
      rgba(var(--blue-rgb), 0.12) 62%,
      rgba(var(--blue-rgb), 0.06) 78%,
      var(--tail) 100%);
  -webkit-mask-image: linear-gradient(to bottom,#000 0,#000 var(--bar-h),rgba(0,0,0,0.65) calc(var(--bar-h) + var(--seam)*.35),rgba(0,0,0,0.28) calc(var(--bar-h)+var(--seam)*.75),transparent calc(var(--bar-h)+var(--seam)));
          mask-image: linear-gradient(to bottom,#000 0,#000 var(--bar-h),rgba(0,0,0,0.65) calc(var(--bar-h) + var(--seam)*.35),rgba(0,0,0,0.28) calc(var(--bar-h)+var(--seam)*.75),transparent calc(var(--bar-h)+var(--seam)));
}
.brandmark{display:flex;align-items:center;justify-content:center;line-height:0}
.brandmark svg{display:block;height:24px;width:auto;transform: scale(var(--wmScale, 1.80));transform-origin: center;}
.brandmark svg path{
  filter: drop-shadow(0 1px 0 rgba(255,255,255,.18)) drop-shadow(0 6px 12px rgba(255,255,255,.18));
}

/* === LAYOUT === */
.monthbar{ display:grid; grid-template-columns:auto 1fr auto; align-items:center; gap:8px; margin:10px 0 6px; }
.monthbar .title{ text-align:center; font-weight:600; letter-spacing:.2px }

/* Nav buttons */
.navbtn{
  appearance:none;border:0;background:transparent;color:var(--actColor);
  font-size:22px;line-height:1;cursor:pointer;padding:6px 8px;border-radius:10px;
  -webkit-tap-highlight-color:transparent;
  transition: background .16s ease, color .16s ease, transform .06s ease;
}
.navbtn:hover{ background:var(--actHover); color:var(--actColorHi); transform:translateY(-1px); }
.navbtn:active{ background:var(--actActive); color:var(--actColorHi); transform:translateY(1px); }

.weekhead{ display:grid; grid-template-columns:repeat(7,1fr); gap:3px; padding:3px 3px 0; }
.view{ display:none } .view.active{ display:block }

/* === CALENDAR GRID === */
.grid{
  display:grid; 
  grid-template-columns:repeat(7,1fr);
  grid-auto-rows:minmax(62px,1fr); 
  gap:6px; 
  padding:3px;
}
.cell{
  position:relative; min-height:84px; border-radius:14px; display:flex; align-items:center; justify-content:center; overflow:hidden;
  background: linear-gradient(180deg, rgba(255,255,255,.14), rgba(255,255,255,.05)), var(--cell-bg) !important;
  border: 1px solid rgba(255,255,255,.20) !important;
  box-shadow: 0 8px 18px rgba(0,0,0,.20), inset 0 1px 0 rgba(255,255,255,.18);
  color:#fff;
}
.cell::before{ content:""; position:absolute; inset:0; border-radius:inherit; background:transparent; transition:background .14s ease, box-shadow .14s ease; pointer-events:none; }
.cell:hover::before{
  background: rgba(255,255,255,.06);
  box-shadow: inset 0 0 0 1px rgba(255,255,255,.30);
}
.cell:active::before{ background: var(--actActive); }

/* Focus per celle editabili */
.cell:focus-within{
  outline: none;
  box-shadow: 0 0 0 1px rgba(255,255,255,.30), var(--focus-ring);
}

/* Numeri giorno */
.num{
  position:absolute; left:8px; top:6px; z-index:1;
  font-size:18px; font-weight:700; color: rgba(255,255,255,.98);
  font-variant-numeric: tabular-nums;
  text-shadow: 0 1px 1px rgba(0,0,0,.35);
}
/* Domeniche: solo NUMERO rosso */
.cell.sun .num{ color: var(--sunday) !important; }
.today.cell.sun .num{ color: var(--sunday) !important; }

/* Giorno “Oggi” — evidenza coerente */
.today::before{
  content:""; position:absolute; inset:0; border-radius:inherit;
  background: var(--tabActiveBg);
  box-shadow:
    inset 0 0 0 1px rgba(255,215,128,.7),   /* filo dorato soft */
    inset 0 1px 0 rgba(255,255,255,.22),
    0 8px 18px rgba(0,0,0,.18);
  pointer-events:none;
}

/* === SIGLE (UNA definizione base) === */
.sigla{
  font-family:'Rajdhani', 'Manrope', system-ui, sans-serif;
  font-size:23px;
  font-weight:600;
  letter-spacing:.35px;
  position:relative; top:8px; z-index:1;
  -webkit-text-stroke:.12px color-mix(in oklch, currentColor 20%, black 80%);
  text-shadow:
    0 0 6px color-mix(in oklch, currentColor 45%, transparent),
    0 1px 1px rgba(255,255,255,.22);
}
/* Rafforzo leggibilità su “oggi” (UNA definizione base) */
.today .sigla{
  -webkit-text-stroke:.16px color-mix(in oklch, currentColor 18%, black 82%);
  text-shadow:
    0 0 7px color-mix(in oklch, currentColor 58%, transparent),
    0 1px 1px rgba(255,255,255,.25);
}

/* Turni colorati */
.T-GL{ color:var(--T-GL); } .T-AP{ color:var(--T-AP); }

/* === RESPONSIVE: mobile === */
@media (max-width:560px){
  main{ padding: 0 6px; }

  .grid{ grid-auto-rows: auto; gap: 2px; padding: 2px; }

  .cell{
    aspect-ratio: 1 / 1;
    min-height: unset;
    height: auto;
    padding: 4px 0;
    border-radius: 10px;
    overflow: hidden;
  }

  .num{
    font-size: 15px;
    font-weight: 800;
    left: 8px; top: 6px;
    -webkit-text-stroke:.15px transparent;
  }

  /* override SOLO per mobile */
  .sigla{
    font-size: 18px;
    top: 10px;
    letter-spacing:.25px;
    font-weight: 600;
    -webkit-text-stroke:.34px rgba(0,0,0,.28);
    text-shadow:
      0 1px 1px rgba(0,0,0,.22);
  }

  .today .sigla{
    -webkit-text-stroke:.4px rgba(0,0,0,.34);
    text-shadow:
      0 1px 1.2px rgba(0,0,0,.28);
  }
}

/* === SETTINGS === */
.settingsCard{
  background: linear-gradient(180deg, var(--surface-glass), rgba(10,20,40,.20)) !important;
  border: 1px solid rgba(255,255,255,.22) !important;
  box-shadow: 0 8px 22px rgba(0,0,0,.22);
  border-radius: 14px;
  padding:14px; margin-top:10px;
}
.settingsRow{display:grid;grid-template-columns:160px 1fr;gap:8px;align-items:center;margin:8px 0}
.settingsRow label{font-weight:600;color:#dfeaff}
.settingsRow input,.settingsRow select{
  width:100%;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,.26);
  background: rgba(12,24,48,.26);color:#fff;height:var(--fieldH);
  box-shadow: inset 0 1px 0 rgba(255,255,255,.14);
}
.settingsRow input::placeholder, .orarioArea::placeholder{ color: rgba(255,255,255,.82); }
.settingsRow select:focus, .settingsRow input:focus, .orarioArea:focus{
  outline: none; box-shadow: var(--focus-ring); border-color: rgba(255,255,255,.48) !important;
}

/* === FORMS === */
.thin-sep{height:0;border-top:1px solid rgba(255,255,255,.24);margin:6px 0}
.iconbtn{width:var(--fieldH);height:var(--fieldH);border-radius:10px;padding:0;font-size:20px;display:flex;align-items:center;justify-content:center;border:0;cursor:pointer}
.iconbtn-primary{background:var(--iosBlue);color:#fff}
.iconbtn-primary:hover{ background: color-mix(in oklch, var(--iosBlue) 85%, white 15%); }
.iconbtn-danger{background:#b42325;color:#fff}
.iconbtn:active{transform:translateY(1px)}
@media(max-width:560px){ .settingsRow{grid-template-columns:120px 1fr} }

/* Hide topbar in settings quando richiesto */
.hide-topbar .topbar{ display: none !important; }
.hide-topbar main{ margin-top: 8px; }

/* === COLOR PICKER === */
.colorCell{ display:flex; align-items:center; justify-content:center; }
.colorInput{
  -webkit-appearance:none; appearance:none;
  width:var(--fieldH); height:var(--fieldH);
  border:1px solid rgba(255,255,255,.26); border-radius:10px; background:transparent;
}
.colorInput::-webkit-color-swatch-wrapper{ padding:0; }
.colorInput::-webkit-color-swatch{ border:none; border-radius:8px; }
.colorInput::-moz-color-swatch{ border:none; border-radius:8px; }
@media (max-width:560px){ :root{ --fieldH:40px; } }

/* === GRID TURNI === */
.turni-grid{ grid-template-columns: 1fr 64px 1.05fr 52px 44px !important; align-items:center; }
.siglaInput{ width:100%; text-transform:uppercase; text-align:center; letter-spacing:.4px; font-family:'Rajdhani','Manrope',system-ui,sans-serif; }
@media (max-width:560px){
  .turni-grid{ grid-template-columns: 1fr 60px 0.85fr 46px 44px !important; }
}

/* === DATE FIELD === */
.settingsRow input[type="date"]{
  width:95%; min-width:0; font-size:1rem; height:38px; line-height:38px;
  text-align:center; margin:0 auto; display:block; border-radius:10px;
}
@media (max-width:560px){
  .settingsRow input[type="date"]{ width:92%; font-size:1.05rem; height:36px; line-height:36px; }
}

/* === MULTILINE SCHEDULE === */
.orarioArea{
  display:block; width:100%; height:calc(var(--fieldH) + 2px);
  padding:6px 8px; resize:none; line-height:1.08; font-size:0.9rem;
  border:1px solid rgba(255,255,255,.26); border-radius:10px; background: rgba(12,24,48,.26); color:#fff;
  white-space:pre;
}
@media (max-width:560px){ .orarioArea{ font-size:0.86rem; height:calc(var(--fieldH)); } }

/* === TABBAR === */
.tabbar{
  position:fixed; bottom:0; left:0; right:0;
  background: linear-gradient(180deg, rgba(255,255,255,.18), rgba(255,255,255,.06)) !important;
  border-top:1px solid rgba(255,255,255,.22);
  display:flex; justify-content:space-around; gap:10px;
  padding:8px 10px calc(8px + env(safe-area-inset-bottom));
  z-index:10;
  backdrop-filter: blur(12px) saturate(140%);
  -webkit-backdrop-filter: blur(12px) saturate(140%);
}
.tab{
  display:flex; flex-direction:column; align-items:center; justify-content:center; gap:4px;
  width:var(--tabW); height:var(--tabH); border-radius:12px; background:transparent;
  color: var(--tabColor); font-size:12px; cursor:pointer; -webkit-tap-highlight-color:transparent;
  transition: background-color .16s ease, color .16s ease, transform .06s ease, box-shadow .16s ease;
}
.tab svg{ width:var(--tabIcon); height:var(--tabIcon); display:block; fill:none; stroke:currentColor; stroke-width:2.25; stroke-linecap:round; stroke-linejoin:round; }
.tab:hover{ background: var(--tabHoverBg); color:#fff; transform:translateY(-1px); }
.tab:active{ background: var(--tabActiveBg); transform:translateY(1px); }
.tab:focus-visible{ outline: none; box-shadow: var(--focus-ring); }
.tab.active{ color: var(--tabColorActive); background: var(--tabActiveBg); font-weight:700; }
.tabbar .tab.active svg{ stroke-width:2.6; }

@media (max-width:560px){ :root{ --tabW:48px; --tabH:40px; --tabIcon:18px; } }

/* === Intestazione giorni === */
.weekhead div{
  background: linear-gradient(180deg, rgba(255,255,255,.22), rgba(255,255,255,.08)) !important;
  border: 1px solid rgba(255,255,255,.24) !important;
  color:#ffffff; text-align:center; padding:8px 0; font-weight:800;
  border-radius:12px; letter-spacing:.03em; font-size:.9rem;
  box-shadow: inset 0 1px 0 rgba(255,255,255,.22);
  text-shadow: 0 1px 1px rgba(0,0,0,.25);
}

/* === Version badge === */
.version-label{
  position: fixed;
  bottom: 6px;
  left: 10px;
  font-weight: 600;
  letter-spacing: .2px;
  color: #e6eeff;
  opacity: .9;
  pointer-events: none;
  user-select: none;
  z-index: 9999;
  font-size: 14px;
  text-shadow: 0 1px 1px rgba(0,0,0,.45);
}
@media (min-width: 1200px){ .version-label{ font-size: 15px; } }
@media (display-mode: standalone){ .version-label{ font-size: 11px; opacity: .78; } }
@media (max-width: 600px){ .version-label{ font-size: 12px; } }

/* === Riduzione motion === */
@media (prefers-reduced-motion: reduce){
  *, *::before, *::after{ transition: none !important; animation: none !important; }
}

/* === Glow topbar più sobrio su desktop larghi === */
@media (min-width: 1200px){
  :root{ --glow-x: 46%; }
  .topbar::before{
    -webkit-mask-image: linear-gradient(to bottom,#000 0,#000 var(--bar-h),
      rgba(0,0,0,0.55) calc(var(--bar-h) + var(--seam)*.35),
      rgba(0,0,0,0.22) calc(var(--bar-h)+var(--seam)*.75),
      transparent calc(var(--bar-h)+var(--seam)));
            mask-image: linear-gradient(to bottom,#000 0,#000 var(--bar-h),
      rgba(0,0,0,0.55) calc(var(--bar-h) + var(--seam)*.35),
      rgba(0,0,0,0.22) calc(var(--bar-h)+var(--seam)*.75),
      transparent calc(var(--bar-h)+var(--seam)));
  }
}
