/* === TYPE (iOS-like ovunque) === */
:root{
  --font-ui: -apple-system, BlinkMacSystemFont, "SF Pro Text", "SF Pro Display",
             "Segoe UI", Roboto, "Helvetica Neue", Arial, system-ui, sans-serif;

  /* Palette su blu istituzionale con sfondo fisso */
  --bg:
    radial-gradient(1400px 900px at 80% -10%, rgba(118,179,255,.22) 0%, rgba(255,255,255,0) 60%),
    linear-gradient(180deg, #1b56c9 0%, #1a5fd9 38%, #1450bd 68%, #0f3e95 100%);

  /* superfici translucide */
  --pill-bg: rgba(255,255,255,.12);
  --pill-brd: rgba(255,255,255,.18);

  /* testi */
  --text:#ffffff; --muted:#c9d5eb;

  /* calendario */
  --sunday:#ff6a6a;
  --cell-brd: rgba(255,255,255,.24);
  --cell-hov: rgba(255,255,255,.14);
  --today-brd: rgba(255,255,255,.82);
  --today-bg:  rgba(255,255,255,.10);

  /* turni speciali */
  --T-GL:#3ccdd0; --T-AP:#ff7dbf;

  /* dimensioni */
  --fieldH:44px;

  /* Tabbar + icons (flex) */
  --tabH: 40px;
  --tabIcon: 26px;
  --tabMaxW: 90px;      /* larghezza massima colonna tab */
  --tabColor:#e2ebff;
  --tabColorActive:#ffffff;

  /* frecce mese (bolla tonda) */
  --navBtnSize: 44px;   /* desktop default */

  /* focus */
  --focus-ring: 0 0 0 2px rgba(74,158,255,.45);
}

/* === BASE === */
*{box-sizing:border-box}
html, body { height: 100%; }
body{
  margin:0;
  background: var(--bg) fixed !important;
  color:var(--text);
  font-family:var(--font-ui);
  -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
}
body.no-scroll { overflow: hidden; }
main{ max-width:760px; margin:8px auto calc(90px + env(safe-area-inset-bottom)); padding:0 10px; }

/* === TOPBAR uniforme con lo sfondo === */
.topbar{
  position: sticky; top: 0; z-index: 20;
  display: flex; align-items: center; justify-content: center;
  padding:10px 12px; height:46px; color:#fff;
  background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
  backdrop-filter: blur(16px) saturate(140%);
  -webkit-backdrop-filter: blur(16px) saturate(140%);
  border: 1px solid color-mix(in oklch, var(--pill-brd) 80%, transparent);
  box-shadow: inset 0 -1px 0 rgba(255,255,255,.16), 0 10px 28px rgba(7,23,54,.18);
}
.brandmark{display:flex;align-items:center;justify-content:center;line-height:0}
.brandmark svg{
  display:block; height:44px; width:auto;
  shape-rendering:geometricPrecision; text-rendering:optimizeLegibility;
  filter: drop-shadow(0 1px 0 rgba(0,0,0,.25)) drop-shadow(0 6px 14px rgba(0,0,0,.18));
}

/* === HEADER MESE + DOW === */
.monthbar{ display:grid; grid-template-columns:auto 1fr auto; align-items:center; gap:8px; margin:10px 0 8px; }
.monthbar .title{ text-align:center; font-weight:800; letter-spacing:.2px; font-size: clamp(18px, 4vw, 22px); }

/* Nav btn: bolla tonda stile iOS */
.navbtn{
  appearance:none;
  border:1px solid var(--pill-brd);
  background:var(--pill-bg);
  color:#fff;

  inline-size: var(--navBtnSize);
  block-size: var(--navBtnSize);
  border-radius: 9999px;
  padding: 0;

  display:inline-flex;
  align-items:center;
  justify-content:center;

  font-size:20px;
  line-height:1;
  cursor:pointer;
  -webkit-tap-highlight-color:transparent;

  transition: background .16s ease, transform .06s ease, box-shadow .16s ease, border-color .16s ease;
  box-shadow: inset 0 1px 0 rgba(255,255,255,.12), 0 2px 8px rgba(0,0,0,.18);
}
.navbtn:hover{
  background: rgba(255,255,255,.16);
  transform: translateY(-1px);
  box-shadow: inset 0 1px 0 rgba(255,255,255,.12), 0 4px 12px rgba(0,0,0,.22);
}
.navbtn:active{
  background: rgba(255,255,255,.10);
  transform: translateY(1px);
  box-shadow: inset 0 1px 0 rgba(255,255,255,.10), 0 2px 8px rgba(0,0,0,.18);
}
.navbtn:focus-visible{
  outline: none;
  box-shadow: 0 0 0 1px rgba(255,255,255,.22), var(--focus-ring);
  border-color: rgba(255,255,255,.42);
}
.navbtn svg{
  width:18px; height:18px; display:block; stroke-width:2.25;
}

/* Giorni settimana: allineati alla grid */
.weekhead{
  display:grid;
  grid-template-columns:repeat(7,1fr);
  gap:6px;               /* come .grid */
  padding:3px;           /* come .grid */
  margin:6px 0 4px;
}
.weekhead div{
  background: transparent;                      /* come .cell */
  border: 1px solid var(--cell-brd);            /* come .cell */
  color: color-mix(in oklch, #fff 96%, transparent);
  text-align:center;
  padding:10px 0;
  font-weight:700;
  letter-spacing:.025em;
  text-transform:uppercase;
  font-size:.90rem;
  border-radius:14px;                            /* come .cell desktop */
  box-shadow: inset 0 1px 0 rgba(255,255,255,.14); /* come .cell */
}

.view{ display:none } .view.active{ display:block }

/* === GRID === */
.grid{
  display:grid;
  grid-template-columns:repeat(7,1fr);
  grid-auto-rows:minmax(62px,1fr);
  gap:6px;
  padding:3px;
  position:relative;
}
.grid.anim{ will-change: transform, opacity; }
.slide-out-left{ animation: outLeft .22s ease forwards }
.slide-in-right{ animation: inRight .22s ease forwards }
.slide-out-right{ animation: outRight .22s ease forwards }
.slide-in-left{ animation: inLeft .22s ease forwards }
@keyframes outLeft{ from{transform:translateX(0); opacity:1} to{transform:translateX(-22px); opacity:0} }
@keyframes inRight{ from{transform:translateX(22px); opacity:0} to{transform:translateX(0); opacity:1} }
@keyframes outRight{ from{transform:translateX(0); opacity:1} to{transform:translateX(22px); opacity:0} }
@keyframes inLeft{ from{transform:translateX(-22px); opacity:0} to{transform:translateX(0); opacity:1} }

/* Celle trasparenti con bordo visibile */
.cell{
  position:relative; display:flex; align-items:center; justify-content:center; overflow:hidden;
  background: transparent !important;
  border: 1px solid var(--cell-brd) !important;
  box-shadow: inset 0 1px 0 rgba(255,255,255,.14);
  color:#fff;
  min-height:84px; border-radius:14px;
}
.cell::before{ content:""; position:absolute; inset:0; border-radius:inherit; background:transparent; transition:background .14s ease, box-shadow .14s ease; pointer-events:none; }
.cell:hover::before{ background: var(--cell-hov); }

/* Celle fuori mese */
.cell.out-month{ opacity: var(--out-opacity, .55); }

/* Focus per celle editabili */
.cell:focus-within{ outline: none; box-shadow: 0 0 0 1px rgba(255,255,255,.22), var(--focus-ring); }

/* Numeri giorno */
.num{
  position:absolute; left:10px; top:8px; z-index:1;
  font-size:16px; font-weight:800; color:#fff;
  font-variant-numeric: tabular-nums;
  text-shadow: 0 1px 0 rgba(0,0,0,.35);
}
/* Domeniche: solo NUMERO rosso */
.cell.sun .num{ color: var(--sunday) !important; }

/* Oggi: bordo + bg */
.today{
  border-color: var(--today-brd) !important;
  box-shadow: inset 0 0 0 1px var(--today-brd), inset 0 1px 0 rgba(255,255,255,.16);
}
.today::before{ background: var(--today-bg); }

/* === SIGLE === */
.sigla{
  font-family:var(--font-ui);
  font-size:20px;
  font-weight:800;
  letter-spacing:.3px;
  position:relative; top:8px; z-index:1;
  text-shadow: 0 1px 0 rgba(0,0,0,.30);
}

/* Turni speciali */
.T-GL{ color:var(--T-GL); } .T-AP{ color:var(--T-AP); }

/* === SETTINGS === */
.settingsCard{
  background: linear-gradient(180deg, rgba(12,24,48,.22), rgba(10,20,40,.16)) !important;
  border: 1px solid rgba(255,255,255,.20) !important;
  box-shadow: 0 8px 22px rgba(0,0,0,.20);
  border-radius: 14px; padding:14px; margin-top:10px;
}
.settingsRow{display:grid;grid-template-columns:160px 1fr;gap:8px;align-items:center;margin:8px 0}
.settingsRow label{font-weight:700;color:#eef4ff}
.settingsRow input,.settingsRow select{
  width:100%;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,.22);
  background: rgba(12,24,48,.20);color:#fff;height:var(--fieldH);
  box-shadow: inset 0 1px 0 rgba(255,255,255,.14);
}
.settingsRow input::placeholder, .orarioArea::placeholder{ color: rgba(255,255,255,.82); }
.settingsRow select:focus, .settingsRow input:focus, .orarioArea:focus{
  outline: none; box-shadow: var(--focus-ring); border-color: rgba(255,255,255,.42) !important;
}

/* === FORMS === */
.thin-sep{height:0;border-top:1px solid rgba(255,255,255,.20);margin:6px 0}
.iconbtn{width:var(--fieldH);height:var(--fieldH);border-radius:10px;padding:0;font-size:20px;display:flex;align-items:center;justify-content:center;border:0;cursor:pointer}
.iconbtn-primary{background:#1976d2;color:#fff}
.iconbtn-primary:hover{ background: color-mix(in oklch, #1976d2 85%, white 15%); }
.iconbtn-danger{background:#b42325;color:#fff}
.iconbtn:active{transform:translateY(1px)}
@media(max-width:560px){ .settingsRow{grid-template-columns:120px 1fr} }

/* Hide topbar in settings quando richiesto */
.hide-topbar .topbar{ display: none !important; }
.hide-topbar main{ margin-top: 8px; }

/* === COLOR PICKER === */
.colorCell{ display:flex; align-items:center; justify-content:center; }
.colorInput{
  -webkit-appearance:none; appearance:none;
  width:var(--fieldH); height:var(--fieldH);
  border:1px solid rgba(255,255,255,.20); border-radius:10px; background:transparent;
}
.colorInput::-webkit-color-swatch-wrapper{ padding:0; }
.colorInput::-webkit-color-swatch{ border:none; border-radius:8px; }
.colorInput::-moz-color-swatch{ border:none; border-radius:8px; }
@media (max-width:560px){ :root{ --fieldH:40px; } }

/* === GRID TURNI === */
.turni-grid{ grid-template-columns: 1fr 64px 1.05fr 52px 44px !important; align-items:center; }
.siglaInput{ width:100%; text-transform:uppercase; text-align:center; letter-spacing:.3px; font-family:var(--font-ui); font-weight:800; }
@media (max-width:560px){
  .turni-grid{ grid-template-columns: 1fr 60px 0.85fr 46px 44px !important; }
}

/* === DATE FIELD === */
.settingsRow input[type="date"]{
  width:95%; min-width:0; font-size:1rem; height:38px; line-height:38px;
  text-align:center; margin:0 auto; display:block; border-radius:10px;
}
@media (max-width:560px){
  .settingsRow input[type="date"]{ width:92%; font-size:1.05rem; height:36px; line-height:36px; }
}

/* === MULTILINE SCHEDULE === */
.orarioArea{
  display:block; width:100%; height:calc(var(--fieldH) + 2px);
  padding:6px 8px; resize:none; line-height:1.08; font-size:0.9rem;
  border:1px solid rgba(255,255,255,.22); border-radius:10px; background: rgba(12,24,48,.20); color:#fff;
  white-space:pre;
}
@media (max-width:560px){ .orarioArea{ font-size:0.86rem; height:calc(var(--fieldH)); } }

/* === TABBAR === */
.tabbar{
  position:fixed; bottom:0; left:0; right:0;
  background: linear-gradient(180deg, rgba(255,255,255,.18), rgba(255,255,255,.06)) !important;
  border-top:1px solid rgba(255,255,255,.20);
  display:flex; justify-content:space-around; gap:10px;
  padding:8px 10px calc(8px + env(safe-area-inset-bottom));
  z-index:10;
  backdrop-filter: blur(12px) saturate(140%);
  -webkit-backdrop-filter: blur(12px) saturate(140%);
}

.tab{
  position: relative;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  gap:4px;
  flex: 1;
  max-width: var(--tabMaxW);
  min-width: 0;
  height: var(--tabH);
  border-radius:12px;
  background:transparent;
  color: var(--tabColor);
  font-size:12px;
  cursor:pointer;
  -webkit-tap-highlight-color:transparent;
  transition: color .18s ease, transform .06s ease, stroke-width .18s ease;
}

/* niente pillole */
.tab::after{ display:none !important; }

.tab > *{ position: relative; z-index: 1; }

/* hover: leggero accento */
.tab:hover{ color: color-mix(in oklch, #fff 94%, transparent); }

/* pressione fisica */
.tab:active{ transform: translateY(1px); }

.tab:focus-visible{ outline: none; box-shadow: var(--focus-ring); }

/* attivo: bianco più puro, spessore più deciso */
.tab.active{
  color: var(--tabColorActive);
  font-weight:700;
}

.tab svg{
  width:var(--tabIcon); height:var(--tabIcon);
  display:block; fill:none;
  stroke:currentColor;
  stroke-width:2.25;
  stroke-linecap:round; stroke-linejoin:round;
  transition: stroke-width .18s ease, color .18s ease;
}

.tab.active svg{ stroke-width:2.6; }


/* === Version badge === */
.version-label{
  position: fixed; bottom: 6px; left: 10px;
  font-weight: 700; letter-spacing: .2px; color: #e6eeff; opacity: .9;
  pointer-events: none; user-select: none; z-index: 9999; font-size: 14px;
  text-shadow: 0 1px 1px rgba(0,0,0,.45);
}

/* === Reduce motion === */
@media (prefers-reduced-motion: reduce){
  *, *::before, *::after{ transition: none !important; animation: none !important; }
}

/* === MOBILE “super” (originali) === */
@media (max-width:560px){
  :root{ --navBtnSize: 36px; }  /* bolla frecce più compatta su mobile */

  /* DOW coerenti con grid anche su mobile */
  .weekhead{
    gap:2px;         /* come .grid mobile */
    padding:2px;     /* come .grid mobile */
    margin:4px 0 2px;
  }
  .weekhead div{
    border-radius:10px;      /* come .cell mobile */
    padding:8px 0;
    font-size:.86rem;
    box-shadow: inset 0 1px 0 rgba(255,255,255,.14);
  }

  .grid{ grid-auto-rows:auto; gap:2px; padding:2px; }

  .cell{
    aspect-ratio: 1 / 1;
    min-height: unset;
    height: auto;
    padding: 4px 0;
    border-radius: 10px;
  }

  .num{
    font-size: 15px;
    font-weight: 800;
    left: 8px;
    top: 6px;
  }

  /* Sigla centrata come in origine (niente bottom), con leggero offset verso il basso */
  .sigla{
    position: relative;
    top: 10px;
    left: auto; right: auto; bottom: auto;
    transform: none;
    font-size: 18px;
    letter-spacing: .25px;
  }
}
